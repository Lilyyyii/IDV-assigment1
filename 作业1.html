<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>PSI Dashboard — Enhanced Visuals</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.cdnfonts.com/css/sf-pro-display" rel="stylesheet">

<style>
    body {
        font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: #0d0d0d;
        color: #ffffff; /* unchanged */
    }

    .glass-card {
        background: #1a1a1a;
        border-left: 5px solid #e53935;
        border-radius: 16px;
        box-shadow: 0 3px 12px rgba(0,0,0,0.6);
        transition: transform 0.25s ease, box-shadow 0.25s ease;
        border: 1px solid #2a2a2a;
    }
    .glass-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 6px 18px rgba(0,0,0,0.8);
    }

    .title {
        font-weight: 700;
        letter-spacing: -0.4px;
        color: #ff3b3b;
    }

    .number {
        font-size: 44px;
        font-weight: 700;
        letter-spacing: -1px;
        color: #ff3b3b;
    }

    .label {
        font-size: 13px;
        color: #f5f5f5;
    }

    table thead { color: #ffffff;
        background: #111;
    }
    table tbody tr:hover {
        background: rgba(229, 57, 53, 0.15);
        transition: 0.2s;
    }

    @keyframes fadeIn {
        from {opacity: 0; transform: translateY(10px);} 
        to {opacity: 1; transform: translateY(0);} 
    }
.neon-blue { color: #ff3b3b; }
table td, table th { color: #ffffff; }
.gold-text { color: #3399ff; }
</style>
</head>
<body class="p-8">

<div class="glass-card p-8 mb-10 fade-in">
    <h1 class="text-4xl title neon-blue">Singapore PSI Monitoring</h1>
    <p id="lastUpdated" class="label mt-2">Last updated: --</p>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12 fade-in">

    <div class="glass-card p-6 text-center">
        <p class="label">Overall PSI</p>
        <p id="overallPsi" class="number mt-2 neon-blue">--</p>
    </div>

    <div class="glass-card p-6 text-center">
        <p class="label">PM2.5 Level</p>
        <p id="pm25Level" class="number mt-2 neon-blue">--</p>
    </div>

    <div class="glass-card p-6 text-center">
        <p class="label">Worst Hit Area</p>
        <p id="worstArea" class="number mt-2 gold-text text-3xl">--</p>
    </div>

</div>

<div class="glass-card p-8 fade-in">
    <h2 class="text-2xl title mb-4">PSI Parameters</h2>
    <table class="w-full text-sm text-white">
        <thead class="border-b border-gray-300 text-white text-xs uppercase">
            <tr>
                <th class="py-2 text-left">Parameter</th>
                <th class="py-2 text-left">National</th>
                <th class="py-2 text-left">Central</th>
                <th class="py-2 text-left">East</th>
                <th class="py-2 text-left">West</th>
                <th class="py-2 text-left">North</th>
                <th class="py-2 text-left">South</th>
            </tr>
        </thead>
        <tbody id="psiTable"></tbody>
    </table>
</div>

<script>
    const tableBody = document.getElementById("psiTable");
    const overallPsiEl = document.getElementById("overallPsi");
    const pm25El = document.getElementById("pm25Level");
    const worstAreaEl = document.getElementById("worstArea");
    const lastUpdatedEl = document.getElementById("lastUpdated");

    const parameters = [
        "o3_sub_index", "pm25_sub_index", "pm10_sub_index",
        "co_sub_index", "so2_sub_index", "no2_sub_index",
        "psi_twenty_four_hourly"
    ];

    const names = {
        o3_sub_index: "O₃ Index",
        pm25_sub_index: "PM2.5 Index",
        pm10_sub_index: "PM10 Index",
        co_sub_index: "CO Index",
        so2_sub_index: "SO₂ Index",
        no2_sub_index: "NO₂ Index",
        psi_twenty_four_hourly: "24h PSI"
    };

    function rand(base) {
        return Math.round(base * (0.9 + Math.random() * 0.2));
    }

    function generateMock() {
        return {
            timestamp: new Date(),
            readings: parameters.reduce((acc, key) => {
                acc[key] = {
                    national: rand(50),
                    central: rand(45),
                    east: rand(40),
                    west: rand(55),
                    north: rand(48),
                    south: rand(52)
                };
                return acc;
            }, {})
        };
    }

    function render(data) {
        const r = data.readings;

        overallPsiEl.textContent = r["psi_twenty_four_hourly"].national;
        pm25El.textContent = r["pm25_sub_index"].national;

        const psi = r["psi_twenty_four_hourly"];
        const worst = Object.keys(psi).reduce((a, b) => psi[a] > psi[b] ? a : b);

        worstAreaEl.textContent = worst;
        lastUpdatedEl.textContent = "Last updated: " + data.timestamp.toLocaleString();

        tableBody.innerHTML = parameters
            .map(p => `
                <tr class="border-t border-gray-200 hover:bg-gray-100/50">
                    <td class="py-2">${names[p]}</td>
                    <td class="py-2">${r[p].national}</td>
                    <td class="py-2">${r[p].central}</td>
                    <td class="py-2">${r[p].east}</td>
                    <td class="py-2">${r[p].west}</td>
                    <td class="py-2">${r[p].north}</td>
                    <td class="py-2">${r[p].south}</td>
                </tr>
            `)
            .join("");
    }

    function init() {
        render(generateMock());
        setInterval(() => {
            render(generateMock());
        }, 60000);
    }

    init();
</script>

</body>
</html>
